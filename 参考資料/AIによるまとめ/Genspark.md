# 小島富治雄氏のプログラミング哲学 - 美しいソースコードの書き方

## はじめに

### 小島富治雄氏について

- **所属**: 福井コンピュータ株式会社 技術開発部 シニアエキスパート
- **コミュニティ**: こみゅぷらす（COMU+）代表
- **資格**: Microsoft MVP Visual Developer - Visual C# (2005-2014)
- **活動**: FITEA（福井情報技術者協会）代表、多数の技術コミュニティで活躍

### 資料の概要

本文書は、小島富治雄氏が2007年から2014年にかけて様々な技術イベント（Developers Summit、Tech Days、わんくま同盟、codeseek勉強会など）で発表された講演資料を基に、氏のプログラミング哲学と実践的なベストプラクティスを体系的にまとめたものです。

---

## 基本哲学：「名前重要。」

小島氏のプログラミング哲学の根幹は「**名前重要。**」という考え方です。この哲学は、まつもとゆきひろ氏の言葉からも影響を受けており、プログラミングにおける命名の重要性を強調しています。

> 「プログラミングでは名前の付け方がとても重要」

---

## 美しいソースコードとは

### 定義

**美しいソースコードとは、拡張と保守がしやすいコードである。**

### 品質の観点

美しいソースコードは、以下の非機能的品質を向上させます：

- ✅ **理解容易性 (understandability)**: わかりやすい
- ✅ **変更容易性 (modifiability)**: 修正・拡張しやすい
- ✅ **検証性 (testability)**: テストしやすい
- ○ **移植性 (portability)**: 他環境への移植が容易
- × **信頼性 (reliability)**: 直接的な効果は限定的
- × **使用性 (usability)**: 直接的な効果は限定的
- × **効率 (efficiency)**: 直接的な効果は限定的

### なぜ美しいコードが必要か

#### 不要論への反論

「動けば何でもいい」という意見に対して：

1. **コスト効率**: 美しいコードの方が開発コストと保守コストが少ない
2. **品質向上**: 高品質で動作し、バグの混入も少ない
3. **長期的価値**: プログラミングは拡張し保守する作業だから、イテレーティブに作っている間も作った後も重要

---

## 美しいソースコードのための七箇条

### 1. 意図を表現

- **意図が表現されていること**
- **意図の理解が容易であること**
- **意図以外の記述が少ないこと**
- **How（どうやってやるか）でなくWhat（何をやるか）が記述されていること**
- **できれば、Why（なぜやるか）も記述されていること**

#### 実践のポイント

- CPUに指示するようでなく、コンパイラに指示するようでなく、**人が人に話すように**記述する
- 「どうやりたいか」ではなく「**何がしたいか**」を重視

### 2. 単一責務

- **プログラムの単位が唯一の仕事を記述していること**
- **その仕事がそのプログラム単位内で記述されつくされていること**（高凝集: high cohesion）

### 3. 的確な名前

- **名前が、それの（唯一の）仕事を（一言で必要十分に）表現していること**
- **同じものは同じ名前で、違うものは違う名前で表現されていること**
- **既知の名前を別の意味で使用しない**
- **問題領域の言葉を意味を変えて使用しない**

### 4. Once And Only Once

- **同じ意図のものが重複して書かれていないこと**
- **それであるものとそれでないものの区別が付くこと**

### 5. 的確に記述されたメソッド

- **メソッド内が同じ抽象度の記述の集まりで構成されていること**
- **メソッド内が、自然な粒度で記述されていること**（話し言葉のように）
- **ほどよい量**（記述が多過ぎない）

### 6. ルールの統一

- **全体が同じルールに従っていること**

### 7. Testable

- **正しい記述であることが分かるようになっていること**
- **検証（verification）が容易であること**

---

## 名前駆動プログラミング

### Name and Conquer（定義攻略）

「**名前で問題を解く**」という考え方：

1. **「ある注目すべきもの」を見つけ、それに名前を付ける**
2. **概念を切り出す** - ある概念を「他のものから」切り分ける
3. **クライアント側のモデルが「名前で」開発を駆動すべき**

### 名前付けのプラクティス

#### 基本原則

1. **概念と名前を一致させる**
2. **同じ概念には同じ名前を付けて、違った概念には違う名前を付ける**
3. **1つの独立した概念のみを表す名前を付ける**
4. **抽象的な概念には抽象的な名前、具体的な概念には具体的な名前を**

#### 良くない名前の例

```csharp
// ❌ 意図がない
int i, i2, i3;

// ❌ 内容物を表していない
tmpWork

// ❌ 読みにくい
lclusrdafName

// ❌ 型との混同を招く
DataTable sName;  // Stringと勘違いしてしまう

// ❌ サンプルコード丸写し
DataSet ds;

// ❌ 不十分な説明
String strBuffer;  // 「だから何のバッファだ!」

// ❌ 意味不明
// 変数名が全部ジャニーズ（実在した新人研修の例）
```

#### 英語での命名規則

普通の英語の文法に従う：

```csharp
// ✅ 正しい例（SV: 主語-動詞、自動詞を使用）
if (line.IntersectsWith(anotherLine))

// ❌ 間違った例（自動詞なのに目的語を取っている）
if (line.Intersect(anotherLine))  // 前置詞が必要
```

---

## 意図を表現するプログラミング

### 宣言型 vs 命令型

#### 宣言型プログラミングの利点

- **What（何をしたいか）**を記述
- より高レベルでの抽象化
- 意図が明確

#### 例：ファイル操作

```csharp
// ❌ 命令型（Howを記述）
FileStream file = File.Open(fileName, FileMode.Create);
// ... データを書き込む複雑な処理
file.Close();

// ✅ 宣言型（Whatを記述）
using (var file = File.CreateText(fileName))
{
    // データを書き込む（意図が明確）
}
```

### DSL（ドメイン特化言語）の活用

問題領域に特化した語彙を作成し、その語彙でロジックを記述する。

---

## マルチパラダイムプログラミング

### パラダイムの種類と使い分け

- **関数型** ⇔ **手続き型** ⇔ **オブジェクト指向型**
- **宣言型** ⇔ **命令型**
- **動的型無し** ⇔ **静的型付き**
- **Generic**
- **並列/並行プログラミング**

### C#の進化とパラダイム

- **C# 1.0**: オブジェクト指向!
- **C# 2.0**: ジェネリック!
- **C# 3.0**: 宣言型! 関数型!
- **C# 4.0**: 動的! 並列処理!

### 適材適所の原則

- **手続き型の限界** → **オブジェクト指向の限界** → **適材適所のパラダイム**
- それぞれのパラダイムには適した問題領域がある

---

## オブジェクト指向設計の実践

### モデリングの考え方

- **「ソースコードを書く」という行為はモデリング**
- **モデル = 関心事が分離されたもの**をコードで記述
- **語彙を作る**: クラスやメソッド、変数で語彙を作ってそれでロジックを記述

### 設計の原則

1. **インターフェイスを作る**
2. **インターフェイスと実装の分離**
3. **変更しやすいように分ける**
4. **テストしやすくなるように分ける**
5. **仕様に対してテスト、実装する**

---

## 実践的なコーディング指針

### プログラミングのコツ

#### Think Simple

- **複雑な問題を解くにはどうしたら良いか** → **複雑な問題を解くような羽目に陥らないようにする**
- **シンプルに書きたいこと（＝意図）だけを書く**

#### バグ対策

- **バグ滞在時間の最小化**
- **フィードバックの最大化**: ツールやテスト、レビューでフィードバックを最速にする
- **見える化**

#### コード構造

- **二重ループなど書かない**
- **配列の配列は一次元配列**
- **関数の仕様**: Howじゃなく What
- **関数の実装**: Howじゃなく What
- **モデルに抽象化する**
- **関数は汎用的に作る**

### 型推論（var）の使用指針

C# 3.0で導入されたvarキーワードの適切な使用方法についても言及されており、意図を明確にするための使い分けが重要。

---

## プログラミング教育への考え方

### 新人教育の原則

- **コーディング技術を軽視できるほどソフトウェア開発技術はまだ発展していない**
- 「ITエンジニアが顧客にとっての価値に目を向けるのは大切」だが、「コーディング技術にこだわるとダメ」という煽りは不要
- **基礎技術の重要性**を理解してもらう

### 学習の進め方

1. **基本原則の理解**
2. **実践を通じた体得**
3. **継続的な改善**（イテレーティブなアプローチ）

---

## まとめ

小島富治雄氏のプログラミング哲学は、単なるテクニックの集合ではなく、**ソフトウェア開発の本質**を捉えた包括的なアプローチです。

### 核心となる考え方

1. **「名前重要。」** - 適切な命名がすべての基礎
2. **意図の表現** - Whatを明確に記述する
3. **継続的改善** - 美しいコードは継続的な努力の結果
4. **実践的品質** - 理論だけでなく実務に活かせる品質向上

### 実践のために

- **七箇条を日々の開発で意識する**
- **Name and Conquerのマインドセットを持つ**
- **マルチパラダイムを適材適所で活用する**
- **Think Simple - 複雑さを避ける設計を心がける**

これらの原則を継続的に実践することで、保守性が高く、理解しやすく、拡張可能な美しいソースコードを書くことができるようになります。

---

*本文書は、小島富治雄氏の2007年から2014年にかけての講演資料を基に作成されました。氏の許可を得て内容をまとめており、プログラミング学習者および実務者の参考資料として提供します。*