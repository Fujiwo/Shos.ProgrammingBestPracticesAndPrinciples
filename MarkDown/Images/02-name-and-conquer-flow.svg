<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="700" viewBox="0 0 1000 700">
  <style>
    .title { font: 600 20px 'Noto Sans JP', Arial, sans-serif; fill:#222 }
    .box { fill:#e8f4ff; stroke:#2b6fb3; stroke-width:1.5 }
    .decision { fill:#fff2cc; stroke:#b38600; stroke-width:1.5 }
    .note { font: 400 12px 'Noto Sans JP', Arial, sans-serif; fill:#333 }
    .label { font: 500 14px 'Noto Sans JP', Arial, sans-serif; fill:#111 }
    .arrow { stroke:#666; stroke-width:2; fill:none; marker-end: url(#arrowhead) }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
    </marker>
  </defs>

  <text x="40" y="36" class="title">図2.2 Name and Conquer — 命名の反復フロー</text>

  <!-- flow boxes -->
  <rect x="80" y="100" width="220" height="70" rx="8" ry="8" class="box"/>
  <text x="190" y="140" text-anchor="middle" class="label">混沌した要求 / 現状</text>
  <text x="190" y="160" text-anchor="middle" class="note">(課題・曖昧な仕様)</text>

  <rect x="320" y="100" width="220" height="70" rx="8" ry="8" class="box"/>
  <text x="430" y="140" text-anchor="middle" class="label">概念抽出</text>
  <text x="430" y="160" text-anchor="middle" class="note">(重要語彙を洗い出す)</text>

  <rect x="560" y="100" width="220" height="70" rx="8" ry="8" class="box"/>
  <text x="670" y="140" text-anchor="middle" class="label">候補に名前を付ける</text>
  <text x="670" y="160" text-anchor="middle" class="note">(ドメイン語彙を定義)</text>

  <rect x="320" y="220" width="220" height="70" rx="8" ry="8" class="box"/>
  <text x="430" y="260" text-anchor="middle" class="label">境界を決める</text>
  <text x="430" y="280" text-anchor="middle" class="note">(責務と範囲を明確化)</text>

  <rect x="560" y="220" width="220" height="70" rx="8" ry="8" class="box"/>
  <text x="670" y="260" text-anchor="middle" class="label">実装へ反映</text>
  <text x="670" y="280" text-anchor="middle" class="note">(クラス/メソッドへ落とし込む)</text>

  <rect x="320" y="340" width="220" height="70" rx="8" ry="8" class="box"/>
  <text x="430" y="380" text-anchor="middle" class="label">レビュー・評価</text>
  <text x="430" y="400" text-anchor="middle" class="note">(可読性・一貫性をチェック)</text>

  <!-- decision diamond -->
  <g>
    <polygon points="670,360 760,420 670,480 580,420" class="decision" stroke="#b38600"/>
    <text x="670" y="420" text-anchor="middle" class="label">改善が必要か</text>
  </g>

  <!-- arrows -->
  <path d="M300 135 L320 135" class="arrow" />
  <path d="M540 135 L560 135" class="arrow" />
  <path d="M430 170 L430 220" class="arrow" />
  <path d="M540 255 L560 255" class="arrow" />
  <path d="M430 290 L430 340" class="arrow" />
  <path d="M540 395 L580 410" class="arrow" />
  <path d="M760 420 L850 420" class="arrow" />

  <!-- loop back arrow from decision Yes to概念抽出 -->
  <path d="M600 480 C560 520,460 520,430 420" class="arrow" />
  <path d="M430 420 L430 380" class="arrow" />

  <!-- final box -->
  <rect x="860" y="380" width="120" height="70" rx="8" ry="8" class="box"/>
  <text x="920" y="420" text-anchor="middle" class="label">語彙に統合
  <tspan x="920" dy="18" class="note">(ドキュメント化)</tspan></text>

  <text x="40" y="660" class="note">注: フローは反復的であり、レビュー結果に応じて語彙を改善すること。</text>
</svg>
